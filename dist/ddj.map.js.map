{"version":3,"sources":["webpack://ddj/webpack/universalModuleDefinition","webpack://ddj/webpack/bootstrap","webpack://ddj/./src/ddj.data.js","webpack://ddj/./src/ddj.tools.js","webpack://ddj/./src/ddj.map.js","webpack://ddj/./src/ddj.mapcontrols.js","webpack://ddj/./src/ddj.marker.js","webpack://ddj/./src/ddj.quickinfo.js","webpack://ddj/./src/ddj.search.js","webpack://ddj/./src/ddj.tutorial.js","webpack://ddj/./src/ddj.autostart.js"],"names":["root","factory","exports","module","define","amd","this","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","store","userData","uniqueIdentifier","getRow","data","geometry","properties","init","type","features","String","startsWith","prefix","indexOf","Array","isArray","obj","toString","getUniqueIdentifier","id","setUniqueIdentifier","identifier","getMetaContent","metaTag","document","querySelector","content","getMetaContentArray","querySelectorAll","length","push","showSelection","selector","show","query","style","display","getSelectionValue","setSelectionValue","getSelectionHTML","innerHTML","getAllObjects","u","allObjects","map","mapDOMelementID","settings","mapboxToken","attribution","centerLat","centerLng","zoom","onFocusOnce","onZoomed","onMoved","set","getDOMName","setDOMName","canInit","L","elementName","initialSettings","tileLayer","attributionOSM","documentElement","lang","join","tileSize","zoomOffset","accessToken","maxZoom","zoomControl","scrollWheelZoom","addLayer","setView","addControl","control","position","once","on","console","error","autostart","element","getElementById","mapCenter","tools","split","trim","onAddCallback","icon","container","DomUtil","$","updateEmbedURI","size","val","x","y","html","outerHTML","replace","Date","getTime","focus","select","ControlInfo","Control","extend","options","onAdd","popup","selectmenu","layerGroup","onAddHTML","onMouseOver","onMouseOut","onClick","undefined","AwesomeMarkers","update","fixGeometryData","lat","lng","latMin","latMax","lngMin","lngMax","a","area","point","coordinates","log","valObj","valCount","addObj","addHTMLObj","uniqueSetId","uniqueId","removeLayer","featureGroup","addTo","addEventListener","evt","latlng","layer","index","count","parseFloat","color","opacity","clickable","iconPrefix","iconFace","htmlClass","htmlIconSize","htmlElement","marker","extraClasses","markerColor","divIcon","className","iconSize","pinColor","pinColorColumn","pinIcon","pinIconColumn","pinIconPrefix","pinIconPrefixColumn","dictYes","dictNo","onShow","onHide","hasClass","close","onclick","setVisible","group","toggleClass","stle","setText","txt","item","CSS","escape","sign","pos","parseInt","slice","formatNumber","tagName","src","infoList","dataArray","infoItems","infoSnippets","remove","clone","appendTo","autostartLib","selectedItem","objects","onFocus","onFormat","orientation","showNoSuggestion","titleNoSuggestion","dataLength","sortValue1","sortValue2","sort","b","htmlDOMelementID","autocomplete","lookup","onSelect","suggestion","formatResult","currentValue","str","RegExp","showNoSuggestionNotice","noSuggestionNotice","noSuggestion","searchTitleColumn","searchDescriptionColumn","description","desc","window","scrollTo","body","scrollTop","animate","updatePagesAndButtons","tutorial","pageElement","page","textContent","pages","find","positionTo","controlgroupLinks","back","css","removeClass","addClass","append","controlgroup","direction","afterclose","gotoFirstPage","onBack","onNext","setTimeout","cors_api_host","origin","open","onDoneCallback","eventPageShowWasSet","updateMapSelectItem","quickinfo","onDone","callback","location","protocol","host","XMLHttpRequest","args","arguments","targetOrigin","exec","toLowerCase","apply","dataUris","dataIgnoreSecondLines","dataIgnoreLastLines","dataNoCaches","dataUniqueIdentifier","dataWFSs","search","selection","items","panTo","LatLng","selectSuggestion","onAlways","hash","history","replaceState","mapcontrols","loadData","dataUri","dataIgnoreSecondLine","dataIgnoreLastLine","dataNoCache","dataWFS","uri","boundaries","WFS","url","typeNS","typeName","crs","CRS","EPSG4326","weight","fitBounds","successCallback","promiseObject","onFail","done","fail","always","request","onreadystatechange","readyState","status","jsonData","JSON","parse","responseText","send","getJSON","jsonObject","shift","pop"],"mappings":"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","file":"ddj.map.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ddj\"] = factory();\n\telse\n\t\troot[\"ddj\"] = factory();\n})(this, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","/*jslint browser: true*/\n/*global $,window*/\n\n// -----------------------------------------------------------------------------\n\nconst store = {\n\tuserData: null,\n\tuniqueIdentifier: null,\n}\n\nexport default store;\n\n// -----------------------------------------------------------------------------\n\nconst settings = {\n};\n\n// -----------------------------------------------------------------------------\n\nexport function getRow(key) {\n\tif (typeof key === 'undefined') {\n\t\treturn store.userData;\n\t}\n\tif (key === null) {\n\t\treturn store.userData;\n\t}\n\n\treturn store.userData[key];\n}\n\n// -----------------------------------------------------------------------------\n\nexport function get(key) {\n\tvar data = getRow(key);\n\n\t// use geojson file\n\tif (data && data.geometry && data.properties) {\n\t\tdata = data.properties;\n\t}\n\n\treturn data;\n}\n\n// -----------------------------------------------------------------------------\n\nexport function init(userData) {\n\tstore.userData = userData;\n\n\t// use geojson file\n\tif (userData && userData.type && (userData.type === 'FeatureCollection') && userData.features) {\n\t\tstore.userData = userData.features;\n\t}\n\n\tString.prototype.startsWith = String.prototype.startsWith || function (prefix) {\n\t\treturn this.indexOf(prefix) === 0;\n\t};\n\n\tif (typeof Array.isArray === 'undefined') {\n\t\tArray.isArray = function (obj) {\n\t\t\treturn Object.prototype.toString.call(obj) === '[object Array]';\n\t\t};\n\t}\n}\n\n// -----------------------------------------------------------------------------\n\nexport function getUniqueIdentifier () {\n\tvar id = store.uniqueIdentifier;\n\n\tif ((typeof id === 'undefined') || (id === undefined) || (id === null) || (id === '')) {\n\t\treturn null;\n\t}\n\n\treturn id;\n}\n\n// -----------------------------------------------------------------------------\n\nexport function setUniqueIdentifier(identifier) {\n\tstore.uniqueIdentifier = identifier;\n}\n\n// -----------------------------------------------------------------------------\n","/*jslint browser: true*/\n/*global document */\n\n// -----------------------------------------------------------------------------\n\nimport * as data from './ddj.data';\n\n// -----------------------------------------------------------------------------\n\nconst store = {\n};\n\nexport default store;\n\n// -----------------------------------------------------------------------------\n\nexport function getMetaContent(name) {\n\tvar metaTag = document.querySelector('meta[name=\"' + name + '\"]');\n\n\tif (metaTag) {\n\t\treturn metaTag.content || '';\n\t}\n\n\treturn '';\n}\n\n// -----------------------------------------------------------------------------\n\nexport function getMetaContentArray(name) {\n\tvar metaTag = document.querySelectorAll('meta[name=\"' + name + '\"]'),\n\t\tcontent = [];\n\n\tif (metaTag) {\n\t\tfor (var m = 0; m < metaTag.length; ++m) {\n\t\t\tcontent.push(metaTag[m].content || '');\n\t\t}\n\n\t}\n\n\treturn content;\n}\n\n// -----------------------------------------------------------------------------\n\nexport function showSelection(selector, show) {\n\tvar query, s;\n\n\tselector = selector || '';\n\tquery = document.querySelectorAll(selector);\n\n\tfor (s = 0; s < query.length; ++s) {\n\t\tquery[s].style.display = show ? 'block' : 'none';\n\t}\n}\n\n// -----------------------------------------------------------------------------\n\nexport function getSelectionValue(selector) {\n\tif (selector) {\n\t\tvar query = document.querySelectorAll(selector);\n\n\t\tif (query.length > 0) {\n\t\t\treturn query[0].value;\n\t\t}\n\t}\n\n\treturn '';\n}\n\n// -----------------------------------------------------------------------------\n\nexport function setSelectionValue(selector, value) {\n\tvar query, s;\n\n\tselector = selector || '';\n\tquery = document.querySelectorAll(selector);\n\n\tfor (s = 0; s < query.length; ++s) {\n\t\tquery[s].value = value;\n\t}\n}\n\n// -----------------------------------------------------------------------------\n\nexport function getSelectionHTML(selector) {\n\tif (selector) {\n\t\tvar query = document.querySelectorAll(selector);\n\n\t\tif (query.length > 0) {\n\t\t\treturn query[0].innerHTML;\n\t\t}\n\t}\n\n\treturn '';\n}\n\n// -----------------------------------------------------------------------------\n\nexport function getAllObjects(obj) {\n\tvar u, allObjects = [], id = data.getUniqueIdentifier();\n\n\tif (id === null) {\n\t\treturn obj;\n\t}\n\n\tfor (u = 0; u < data.default.userData.length; ++u) {\n\t\tif (data.default.userData[u][id] === obj[id]) {\n\t\t\tallObjects.push(data.default.userData[u]);\n\t\t}\n\t}\n\n\tif (allObjects.length === 1) {\n\t\treturn allObjects[0];\n\t}\n\n\treturn allObjects;\n}\n\n// -----------------------------------------------------------------------------\n","/*jslint browser: true*/\n/*global L,document,console*/\n\n// -----------------------------------------------------------------------------\n\nimport * as tools from './ddj.tools';\n\n// -----------------------------------------------------------------------------\n\nconst store = {\n\tmap: null,\n\tmapDOMelementID: '',\n}\n\nexport default store;\n\n// -----------------------------------------------------------------------------\n\nconst settings = {\n\tmapboxToken: '',\n\tattribution: '',\n\tcenterLat: 52.518413,\n\tcenterLng: 13.408368,\n\tzoom: 13,\n\tonFocusOnce: null,\n\tonZoomed: null,\n\tonMoved: null\n};\n\n// -----------------------------------------------------------------------------\n\nString.prototype.startsWith = String.prototype.startsWith || function (prefix) {\n\t'use strict';\n\n\treturn this.indexOf(prefix) === 0;\n};\n\n// -----------------------------------------------------------------------------\n\nexport function get() {\n\treturn store.map;\n}\n\n// -----------------------------------------------------------------------------\n\nexport function set(map) {\n\tstore.map = map;\n}\n\n// -----------------------------------------------------------------------------\n\nexport function getDOMName() {\n\treturn store.mapDOMelementID;\n}\n\n// -----------------------------------------------------------------------------\n\nexport function setDOMName(name) {\n\tstore.mapDOMelementID = name;\n}\n\n// -----------------------------------------------------------------------------\n\nexport function canInit() {\n\tif ((typeof L === 'undefined') || (L === null)) {\n\t\treturn false;\n\t}\n\treturn true;\n}\n\n// -----------------------------------------------------------------------------\n\nexport function init(elementName, initialSettings) {\n\tif (null !== get()) {\n\t\treturn;\n\t}\n\tif (!canInit()) {\n\t\tconsole.error('Error: Please include leaflet.js in your html file.');\n\t\treturn;\n\t}\n\n\tvar key, tileLayer, attribution = [], attributionOSM;\n\n\tif ((initialSettings !== null) && (typeof (initialSettings) === 'object')) {\n\t\tfor (key in initialSettings) {\n\t\t\tif (initialSettings.hasOwnProperty(key) && settings.hasOwnProperty(key)) {\n\t\t\t\tsettings[key] = initialSettings[key];\n\t\t\t}\n\t\t}\n\t}\n\n\tif (document.documentElement.lang === 'de') {\n\t\tattributionOSM = '&copy; <a href=\"https://www.openstreetmap.org/copyright\" target=\"_blank\">OpenStreetMap</a>-Mitwirkende';\n\t} else {\n\t\tattributionOSM = '&copy; <a href=\"https://www.openstreetmap.org/copyright\" target=\"_blank\">OpenStreetMap</a> contributors';\n\t}\n\n\tif (settings.mapboxToken !== '') {\n\t\tattribution.push(attributionOSM);\n\t\tattribution.push('<a href=\"https://www.mapbox.com\" target=\"_blank\">Mapbox</a>');\n\t\tif (settings.attribution !== '') {\n\t\t\tattribution.push(settings.attribution);\n\t\t}\n\n\t\ttileLayer = L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}', {\n\t\t\tattribution: attribution.join(', '),\n\t\t\ttileSize: 512,\n\t\t\tzoomOffset: -1,\n\t\t\tid: 'mapbox/streets-v11',\n\t\t\taccessToken: settings.mapboxToken,\n\t\t});\n\t} else {\n\t\tattribution.push(attributionOSM);\n\t\tif (settings.attribution !== '') {\n\t\t\tattribution.push(settings.attribution);\n\t\t}\n\n\t\ttileLayer = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n\t\t\tattribution: attribution.join(', '),\n\t\t\tmaxZoom: 19,\n\t\t});\n\t}\n\n\tsetDOMName(elementName);\n\tset(L.map(elementName, {zoomControl: false, scrollWheelZoom: true})\n\t\t.addLayer(tileLayer)\n\t\t.setView([settings.centerLat, settings.centerLng], settings.zoom));\n\n\tget().addControl(L.control.zoom({ position: 'bottomright'}));\n\tget().once('focus', function () {\n\t\tif (settings.onFocusOnce) {\n\t\t\tsettings.onFocusOnce();\n\t\t}\n\t});\n\tget().on('zoomend', function () {\n\t\tif (settings.onZoomed) {\n\t\t\tsettings.onZoomed();\n\t\t}\n\t});\n\tget().on('moveend', function () {\n\t\tif (settings.onMoved) {\n\t\t\tsettings.onMoved();\n\t\t}\n\t});\n}\n\n// -----------------------------------------------------------------------------\n\nexport function autostart() {\n\tvar elementId = 'map',\n\t\telement = document.getElementById(elementId),\n\t\tmapCenter = tools.getMetaContent('ddj:mapCenter'),\n\t\tattribution = document.querySelectorAll('[data-map=\"attribution\"]') || [];\n\n\tif (element && (mapCenter.split(',').length === 2)) {\n\t\tinit(elementId, {\n\t\t\tmapboxToken: tools.getMetaContent('ddj:mapboxToken') || '',\n\t\t\tattribution: attribution.length > 0 ? attribution[0].innerHTML : '',\n\t\t\tcenterLat: mapCenter.split(',')[0].trim(),\n\t\t\tcenterLng: mapCenter.split(',')[1].trim(),\n\t\t\tzoom: tools.getMetaContent('ddj:mapZoom'),\n\t\t});\n\t}\n}\n\n// -----------------------------------------------------------------------------\n","/*jslint browser: true*/\n/*global L,$*/\n\n// -----------------------------------------------------------------------------\n\nimport * as map from './ddj.map';\nimport * as tools from './ddj.tools';\n\n// -----------------------------------------------------------------------------\n\nconst store = {\n}\n\nexport default store;\n\n// -----------------------------------------------------------------------------\n\nconst settings = {\n};\n\n// -----------------------------------------------------------------------------\n\nfunction onAddCallback() {\n\tvar container = L.DomUtil.create('div', 'leaflet-bar leaflet-control leaflet-control-custom'),\n\t\ticon;\n\n\tif (document.querySelector('[data-share=\"dialog\"]')) {\n\t\ticon = $('[data-share=\"dialog\"]').data('icon') || 'fa fa-share-alt';\n\t\tcontainer.innerHTML = '<a style=\"font-size:1.2em\" href=\"#popupShare\" title=\"Teilen\" data-rel=\"popup\" data-position-to=\"window\" data-transition=\"pop\"><i class=\"' + icon + '\" aria-hidden=\"true\"></i></a>';\n\t}\n\tif (document.querySelector('[data-info=\"dialog\"]')) {\n\t\ticon = $('#popupInfo').data('icon') || 'fa fa-info';\n\t\tcontainer.innerHTML += '<a style=\"font-size:1.2em\" href=\"#popupInfo\" title=\"Info\" data-rel=\"popup\" data-position-to=\"window\" data-transition=\"pop\"><i class=\"' + icon + '\" aria-hidden=\"true\"></i></a>';\n\t}\n\tif (document.querySelector('[data-author=\"dialog\"]')) {\n\t\ticon = $('#popupAuthor').data('icon') || 'fa fa-envelope';\n\t\tcontainer.innerHTML += '<a style=\"font-size:1.2em\" href=\"#popupAuthor\" title=\"Autor\" data-rel=\"popup\" data-position-to=\"window\" data-transition=\"pop\"><i class=\"' + icon + '\" aria-hidden=\"true\"></i></a>';\n\t}\n\tif (document.querySelector('[data-tutorial=\"dialog\"]')) {\n\t\ticon = $('[data-tutorial=\"dialog\"]').data('icon') || 'fa fa-graduation-cap';\n\t\tcontainer.innerHTML += '<a style=\"font-size:1.2em\" href=\"#popupTutorial\" title=\"Anleitung\" data-rel=\"popup\" data-position-to=\"window\" data-transition=\"pop\"><i class=\"' + icon + '\" aria-hidden=\"true\"></i></a>';\n\t}\n\n\treturn container;\n}\n\n// -----------------------------------------------------------------------------\n\nfunction updateEmbedURI() {\n\tvar size = $('#selectEmbedSize').val().split('x'),\n\t\tx = size[0],\n\t\ty = size[1],\n\t\tdataShareURI = tools.getMetaContent('ddj:shareURI') || '',\n\t\thtml = '<iframe src=\"' + dataShareURI + '\" width=\"' + x + '\" height=\"' + y + '\" frameborder=\"0\" style=\"border:0\" allowfullscreen></iframe>';\n\n\t$('#inputEmbedURI').val(html);\n\tif (-1 === $('#embedMap iframe')[0].outerHTML.indexOf('width=\"' + x + '\"')) {\n\t\t$('#embedMap iframe')[0].outerHTML = html.replace('.html\"', '.html?foo=' + (new Date().getTime()) + '\"');\n\t\t$('#embedMap input').focus().select();\n\t}\n}\n\n// -----------------------------------------------------------------------------\n\nexport function init(initialSettings) {\n\tif (null === map.get()) {\n\t\treturn;\n\t}\n\n\tvar key;\n\n\tif ((initialSettings !== null) && (typeof (initialSettings) === 'object')) {\n\t\tfor (key in initialSettings) {\n\t\t\tif (initialSettings.hasOwnProperty(key) && settings.hasOwnProperty(key)) {\n\t\t\t\tsettings[key] = initialSettings[key];\n\t\t\t}\n\t\t}\n\t}\n\n\tvar ControlInfo = L.Control.extend({\n\t\toptions: {\n\t\t\tposition: 'bottomright',\n\t\t},\n\t\tonAdd: onAddCallback,\n\t});\n\tmap.get().addControl(new ControlInfo());\n\n\tif (document.querySelector('[data-share=\"dialog\"]')) {\n\t\t$(\"#popupShare\").on('popupafteropen', function () {\n\t\t\t$('#shareLink input').focus().select();\n\t\t});\n\t\t$('#tabShareLink').on('click', function () {\n\t\t\t$('#popupShare').popup('reposition', 'positionTo: window');\n\t\t\t$('#shareLink input').focus().select();\n\t\t});\n\t\t$('#tabEmbedMap').on('click', function () {\n\t\t\tupdateEmbedURI();\n\t\t\t$('#popupShare').popup('reposition', 'positionTo: window');\n\t\t\t$('#embedMap input').focus().select();\n\t\t});\n\n\t\t$('#selectEmbedSize').val('400x300').selectmenu('refresh');\n\t\t$('#selectEmbedSize').on('change', function () {\n\t\t\tupdateEmbedURI();\n\t\t\t$('#popupShare').popup('reposition', 'positionTo: window');\n\t\t});\n\t}\n}\n\n// -----------------------------------------------------------------------------\n\nexport function autostart() {\n\tinit();\n}\n\n// -----------------------------------------------------------------------------\n","/*jslint browser: true*/\n/*global L,console*/\n\n// -----------------------------------------------------------------------------\n\nimport * as data from './ddj.data';\nimport * as map from './ddj.map';\nimport * as tools from './ddj.tools';\n\n// -----------------------------------------------------------------------------\n\nconst store = {\n\tlayerGroup: null\n}\n\nexport default store;\n\n// -----------------------------------------------------------------------------\n\nconst settings = {\n\tonAdd: function () {\n\t\treturn true;\n\t},\n\tonAddHTML: function () {\n\t\treturn false;\n\t},\n\tonMouseOver: null,\n\tonMouseOut: null,\n\tonClick: null\n};\n\n// -----------------------------------------------------------------------------\n\nexport function canInit() {\n\tif ((typeof L === 'undefined') || (L === null) || (L.AwesomeMarkers === undefined)) {\n\t\treturn false;\n\t}\n\treturn true;\n}\n\n// -----------------------------------------------------------------------------\n\nexport function init(initialSettings) {\n\tif (null !== store.layerGroup) {\n\t\treturn;\n\t}\n\tif (!canInit()) {\n\t\tconsole.error('Error: Please include leaflet.js and Leaflet.awesome-markers,js in your html file.');\n\t\treturn;\n\t}\n\n\tvar key;\n\n\tif ((initialSettings !== null) && (typeof (initialSettings) === 'object')) {\n\t\tfor (key in initialSettings) {\n\t\t\tif (initialSettings.hasOwnProperty(key) && settings.hasOwnProperty(key)) {\n\t\t\t\tsettings[key] = initialSettings[key];\n\t\t\t}\n\t\t}\n\t}\n\n\tupdate();\n}\n\n// -----------------------------------------------------------------------------\n\nexport function fixGeometryData(val) {\n\tif (val.geometry && val.properties) {\n\t\tvar lat, lng, latMin, latMax, lngMin, lngMax, a, area, p, point;\n\n\t\tif (val.geometry.type === 'Polygon') {\n\t\t\tlatMin = val.geometry.coordinates[0][0][1];\n\t\t\tlatMax = val.geometry.coordinates[0][0][1];\n\t\t\tlngMin = val.geometry.coordinates[0][0][0];\n\t\t\tlngMax = val.geometry.coordinates[0][0][0];\n\n\t\t\tfor (a = 0; a < val.geometry.coordinates.length; ++a) {\n\t\t\t\tarea = val.geometry.coordinates[a];\n\n\t\t\t\tfor (p = 0; p < area.length; ++p) {\n\t\t\t\t\tpoint = area[p];\n\n\t\t\t\t\tif (point[1] < latMin) {\n\t\t\t\t\t\tlatMin = point[1];\n\t\t\t\t\t}\n\t\t\t\t\tif (point[1] > latMax) {\n\t\t\t\t\t\tlatMax = point[1];\n\t\t\t\t\t}\n\t\t\t\t\tif (point[0] < lngMin) {\n\t\t\t\t\t\tlngMin = point[0];\n\t\t\t\t\t}\n\t\t\t\t\tif (point[0] > lngMax) {\n\t\t\t\t\t\tlngMax = point[0];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tlat = (latMin + latMax) / 2;\n\t\t\tlng = (lngMin + lngMax) / 2;\n\t\t} else if (val.geometry.type === 'Point') {\n\t\t\tlat = val.geometry.coordinates[1];\n\t\t\tlng = val.geometry.coordinates[0];\n\t\t} else {\n\t\t\tconsole.log(val.geometry.type + ' not yet implemented');\n\t\t}\n\n\t\tval = val.properties;\n\t\tval.lat = val.lat || lat;\n\t\tval.lng = val.lng || lng;\n\t}\n\n\treturn val;\n}\n\n// -----------------------------------------------------------------------------\n\nexport function update() {\n\tvar key, valObj, val, valCount, obj, addObj, addHTMLObj, uniqueSetId = [], uniqueId = data.getUniqueIdentifier();\n\n\tif (store.layerGroup) {\n\t\tmap.get().removeLayer(store.layerGroup);\n\t\tstore.layerGroup = null;\n\t}\n\n\tstore.layerGroup = L.featureGroup([]);\n\tstore.layerGroup.addTo(map.get());\n\tstore.layerGroup.addEventListener('mouseover', function (evt) {\n\t\tif (settings.onMouseOver) {\n\t\t\tsettings.onMouseOver([evt.latlng.lat, evt.latlng.lng], data.get(evt.layer.options.data));\n\t\t}\n\t});\n\tstore.layerGroup.addEventListener('mouseout', function (evt) {\n\t\tif (settings.onMouseOut) {\n\t\t\tsettings.onMouseOut([evt.latlng.lat, evt.latlng.lng], data.get(evt.layer.options.data));\n\t\t}\n\t});\n\tstore.layerGroup.addEventListener('click', function (evt) {\n\t\tif (settings.onClick) {\n\t\t\tsettings.onClick([evt.latlng.lat, evt.latlng.lng], data.get(evt.layer.options.data));\n\t\t}\n\t});\n\nif (data.getRow()) {\n\tfor (key = 0; key < data.getRow().length; ++key) {\n\t\tval = data.getRow(key);\n\t\tval = fixGeometryData(val);\n\t\tvalObj = val;\n\t\tvalCount = 1;\n\n\t\tif (Array.isArray(valObj)) {\n\t\t\tval = valObj[0];\n\t\t\tvalCount = valObj.length;\n\t\t}\n\n\t\tif ((uniqueId !== null) && (uniqueSetId.indexOf(val[uniqueId]) > -1)) {\n\t\t\t// add marker only once\n\t\t\tcontinue;\n\t\t}\n\n\t\tif ((typeof val.lat !== 'undefined') && (val.lat !== '') && (typeof val.lng !== 'undefined') && (val.lng !== '')) {\n\t\t\tobj = {\n\t\t\t\tindex: key,\n\t\t\t\tcount: valCount,\n\t\t\t\tlat: parseFloat(val.lat),\n\t\t\t\tlng: parseFloat(val.lng),\n\t\t\t\tcolor: 'blue',\n\t\t\t\topacity: 1,\n\t\t\t\tclickable: 1,\n\t\t\t\ticonPrefix: 'fa',\n\t\t\t\ticonFace: 'fa-dot-circle-o',\n\t\t\t\thtmlClass: '',\n\t\t\t\thtmlIconSize: null,\n\t\t\t\thtmlElement: ''\n\t\t\t};\n\t\t\ttry {\n\t\t\t\taddObj = settings.onAdd(obj, val);\n\t\t\t} catch (x) {\n\t\t\t\tconsole.log(x);\n\t\t\t\taddObj = false;\n\t\t\t}\n\t\t\ttry {\n\t\t\t\taddHTMLObj = settings.onAddHTML(obj, val);\n\t\t\t} catch (y) {\n\t\t\t\tconsole.log(y);\n\t\t\t\taddHTMLObj = false;\n\t\t\t}\n\n\t\t\tif (addObj !== false) {\n\t\t\t\tstore.layerGroup.addLayer(L.marker([obj.lat, obj.lng], {\n\t\t\t\t\tdata: obj.index,\n\t\t\t\t\ticon: L.AwesomeMarkers.icon({\n\t\t\t\t\t\tprefix: 'fa',\n\t\t\t\t\t\textraClasses: obj.iconPrefix,\n\t\t\t\t\t\ticon: obj.iconFace,\n\t\t\t\t\t\tmarkerColor: obj.color\n\t\t\t\t\t}),\n\t\t\t\t\topacity: obj.opacity,\n\t\t\t\t\tclickable: obj.clickable\n\t\t\t\t}));\n\n\t\t\t\tuniqueSetId.push(val[uniqueId]);\n\t\t\t}\n\t\t\tif (addHTMLObj !== false) {\n\t\t\t\tstore.layerGroup.addLayer(L.marker([obj.lat, obj.lng], {\n\t\t\t\t\tdata: obj.index,\n\t\t\t\t\ticon: L.divIcon({\n\t\t\t\t\t\tclassName: obj.htmlClass,\n\t\t\t\t\t\ticonSize: obj.htmlIconSize,\n\t\t\t\t\t\thtml: obj.htmlElement\n\t\t\t\t\t}),\n\t\t\t\t\topacity: obj.opacity,\n\t\t\t\t\tclickable: obj.clickable\n\t\t\t\t}));\n\n\t\t\t\tuniqueSetId.push(val[uniqueId]);\n\t\t\t}\n\t\t}\n\t\t}\n\t}\n}\n\n// -----------------------------------------------------------------------------\n\nexport function autostart(options) {\n\tvar pinColor = tools.getMetaContent('ddj:pinColor') || '',\n\t\tpinColorColumn = tools.getMetaContent('ddj:pinColorColumn') || '',\n\t\tpinIcon = tools.getMetaContent('ddj:pinIcon') || '',\n\t\tpinIconColumn = tools.getMetaContent('ddj:pinIconColumn') || '',\n\t\tpinIconPrefix = tools.getMetaContent('ddj:pinIconPrefix') || '',\n\t\tpinIconPrefixColumn = tools.getMetaContent('ddj:pinIconPrefixColumn') || '';\n\n\tif (canInit()) {\n\t\tinit({\n\t\t\tonAdd: function (marker, value) {\n\t\t\t\tif (pinColor !== '') {\n\t\t\t\t\tmarker.color = pinColor;\n\t\t\t\t}\n\t\t\t\tif ((pinColorColumn !== '') && value[pinColorColumn]) {\n\t\t\t\t\tmarker.color = value[pinColorColumn];\n\t\t\t\t}\n\n\t\t\t\tif (pinIcon !== '') {\n\t\t\t\t\tmarker.iconPrefix = pinIconPrefix;\n\t\t\t\t\tmarker.iconFace = pinIcon;\n\t\t\t\t}\n\t\t\t\tif ((pinIconColumn !== '') && value[pinIconColumn]) {\n\t\t\t\t\tmarker.iconPrefix = value[pinIconPrefixColumn];\n\t\t\t\t\tmarker.iconFace = value[pinIconColumn];\n\t\t\t\t}\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tonClick: function (latlng, data) {\n\t\t\t\tif (options.onClick) {\n\t\t\t\t\toptions.onClick(latlng, data);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n\n// -----------------------------------------------------------------------------\n","/*jslint browser: true*/\n/*global $*/\n\n// -----------------------------------------------------------------------------\n\nimport * as autostartLib from './ddj.autostart';\nimport * as tools from './ddj.tools';\n\n// -----------------------------------------------------------------------------\n\nconst store = {\n\troot: null\n}\n\nexport default store;\n\n// -----------------------------------------------------------------------------\n\nconst settings = {\n\tdictYes: 'ja',\n\tdictNo: 'nein',\n\tonShow: null,\n\tonHide: null\n};\n\n// -----------------------------------------------------------------------------\n\nfunction formatNumber(txt) {\n\ttxt = String(parseInt(txt, 10));\n\tvar sign = '',\n\t\tpos = 0;\n\tif (txt[0] === '-') {\n\t\tsign = '-';\n\t\ttxt = txt.slice(1);\n\t}\n\n\tpos = txt.length;\n\twhile (pos > 3) {\n\t\tpos -= 3;\n\t\ttxt = txt.slice(0, pos) + '.' + txt.slice(pos);\n\t}\n\n\treturn sign + txt;\n}\n\n// -----------------------------------------------------------------------------\n\nfunction hasClass(element, className) {\n    return (' ' + element.className + ' ').indexOf(' ' + className+ ' ') > -1;\n}\n\n// -----------------------------------------------------------------------------\n\nexport function init(initialSettings) {\n\tif (store.root !== null) {\n\t\treturn;\n\t}\n\n\tvar key;\n\n\tif ((initialSettings !== null) && (typeof (initialSettings) === 'object')) {\n\t\tfor (key in initialSettings) {\n\t\t\tif (initialSettings.hasOwnProperty(key) && settings.hasOwnProperty(key)) {\n\t\t\t\tsettings[key] = initialSettings[key];\n\t\t\t}\n\t\t}\n\t}\n\n\tstore.root = document.querySelector('[data-quickinfo=\"box\"]');\n\n\tif (store.root) {\n\t\tvar close = store.root.querySelector('[data-quickinfo=\"close\"]');\n\t\tif (close) {\n\t\t\tclose.onclick = function () {\n\t\t\t\tsetVisible(false);\n\t\t\t};\n\t\t}\n\t\tvar group = store.root.querySelector('[data-quickinfo=\"group\"]');\n\t\tif (group) {\n\t\t\tgroup.onclick = function () {\n\t\t\t\t$(this).toggleClass('groupClosed');\n\t\t\t};\n\t\t}\n\n\t\tupdate();\n\t}\n}\n\n// -----------------------------------------------------------------------------\n\nexport function update() {\n}\n\n// -----------------------------------------------------------------------------\n\nexport function setVisible(show) {\n\tif (show) {\n\t\tstore.root.style.display = 'block';\n\t\tif (settings.onShow) {\n\t\t\tsettings.onShow();\n\t\t}\n\t} else {\n\t\tstore.root.stle.display = 'none';\n\t\tif (settings.onHide) {\n\t\t\tsettings.onHide();\n\t\t}\n\t}\n}\n\n// -----------------------------------------------------------------------------\n\nexport function show(obj) {\n\tfunction setText(key, txt) {\n\t\tvar item = store.root.querySelectorAll('[data-quickdata=\"' + CSS.escape(key) + '\"]');\n\n\t\tif (item.length > 0) {\n\t\t\tif (hasClass(item[0], 'number')) {\n\t\t\t\ttxt = formatNumber(txt);\n\t\t\t} else if (hasClass(item[0], 'boolean')) {\n\t\t\t\ttxt = (txt === 1 ? settings.dictYes : settings.dictNo);\n\t\t\t}\n\n\t\t\tif (item[0].tagName === 'IMG') {\n\t\t\t\titem[0].src = txt;\n\t\t\t} else {\n\t\t\t\titem[0].innerHTML = txt;\n\t\t\t}\n\t\t}\n\n\t\titem = store.root.querySelectorAll('[data-hide-if-zero=\"' + CSS.escape(key) + '\"]');\n\n\t\tif (item.length > 0) {\n\t\t\tvar show = 'block';\n\t\t\tif ((txt === '0') || (txt === 0) || (txt === null)) {\n\t\t\t\tshow = 'none';\n\t\t\t}\n\n\t\t\titem[0].style.display = show;\n\t\t}\n\t}\n\n\tif (store.root === null) {\n\t\treturn;\n\t}\n\n\tvar d, data, dataArray = obj, key, i, infoList, infoItems = [], infoSnippets = [];\n\n\tif (!Array.isArray(dataArray)) {\n\t\tdataArray = [obj];\n\t}\n\n\tinfoList = store.root.querySelectorAll('[data-quickinfo=\"list\"]');\n\tif (infoList.length === 1) {\n\t\tinfoItems = infoList[0].querySelectorAll('[data-quickinfo=\"item\"]');\n\n\t\twhile (infoItems.length > 1) {\n\t\t\t$(infoItems[0]).remove();\n\t\t\tinfoItems = infoList[0].querySelectorAll('[data-quickinfo=\"item\"]');\n\t\t}\n\t}\n\n\tfor (d = 0; d < dataArray.length; ++d) {\n\t\tdata = dataArray[d];\n\n\t\tfor (key in data) {\n\t\t\tif (data.hasOwnProperty(key)) {\n\t\t\t\tsetText(key, data[key]);\n\t\t\t}\n\t\t}\n\n\t\tif (infoItems.length > 0) {\n\t\t\tinfoSnippets.push($(infoItems[0]).clone());\n\t\t}\n\t}\n\n\tif (infoItems.length > 0) {\n\t\t$(infoItems[0]).remove();\n\t\tfor (i = 0; i < infoSnippets.length; ++i) {\n\t\t\tinfoSnippets[i].appendTo(infoList);\n\t\t}\n\t}\n\n\tsetVisible(true);\n}\n\n// -----------------------------------------------------------------------------\n\nexport function autostart() {\n\tinit({\n\t\tonShow: function () {\n\t\t\ttools.showSelection('[data-welcome=\"box\"]', false);\n\t\t},\n\t\tonHide: function () {\n\t\t\ttools.setSelectionValue('[data-search=\"textinput\"]', '');\n\t\t\ttools.showSelection('[data-welcome=\"box\"]', true);\n\n\t\t\tautostartLib.default.selectedItem = null;\n\t\t}\n\t});\n}\n\n// -----------------------------------------------------------------------------\n","/*jslint browser: true*/\n/*global $,window,document */\n\n// -----------------------------------------------------------------------------\n\nimport * as data from './ddj.data';\nimport * as tools from './ddj.tools';\n\n// -----------------------------------------------------------------------------\n\nconst store = {\n\tobjects: [],\n\troot: null\n}\n\nexport default store;\n\n// -----------------------------------------------------------------------------\n\nconst settings = {\n\tonAdd: function () {\n\t\treturn true;\n\t},\n\tonClick: null,\n\tonFocus: null,\n\tonFormat: null,\n\torientation: 'bottom',\n\tshowNoSuggestion: true,\n\ttitleNoSuggestion: '<i class=\"fa fa-info-circle\" aria-hidden=\"true\"></i> Geben sie bitte einen Suchbegriff ein'\n};\n\n// -----------------------------------------------------------------------------\n\nexport function init(initialSettings) {\n\tif (0 !== store.objects.length) {\n\t\treturn;\n\t}\n\n\tvar key;\n\n\tif ((initialSettings !== null) && (typeof (initialSettings) === 'object')) {\n\t\tfor (key in initialSettings) {\n\t\t\tif (initialSettings.hasOwnProperty(key) && settings.hasOwnProperty(key)) {\n\t\t\t\tsettings[key] = initialSettings[key];\n\t\t\t}\n\t\t}\n\t}\n\n\tstore.root = document.querySelector('[data-search=\"box\"]');\n\n\tif (store.root) {\n\t\tstore.root.addEventListener('focus', function () {\n\t\t\tif (settings.onFocus) {\n\t\t\t\tsettings.onFocus();\n\t\t\t}\n\t\t});\n\n\t\tupdate();\n\t}\n}\n\n// -----------------------------------------------------------------------------\n\nexport function update() {\n\tvar key, val, valObj, valCount, obj, addObj, dataLength = 0,\n\t\tuniqueSetId = [],\n\t\tuniqueId = data.getUniqueIdentifier();\n\n\tif (data.get()) {\n\t\tdataLength = data.get().length;\n\t}\n\tstore.objects = [];\n\n\tfor (key = 0; key < dataLength; ++key) {\n\t\tval = valObj = data.get(key);\n\t\tvalCount = 1;\n\n\t\tif (Array.isArray(valObj)) {\n\t\t\tval = valObj[0];\n\t\t\tvalCount = valObj.length;\n\t\t}\n\n\t\tif ((uniqueId !== null) && (uniqueSetId.indexOf(val[uniqueId]) > -1)) {\n\t\t\t// add to search only once\n\t\t\tcontinue;\n\t\t}\n\n\t\tobj = {\n\t\t\tindex: key,\n\t\t\tcount: valCount,\n\t\t\tvalue: '',\n\t\t\tsortValue1: key,\n\t\t\tsortValue2: key\n\t\t};\n\t\taddObj = settings.onAdd(obj, val);\n\n\t\tif (addObj !== false) {\n\t\t\tstore.objects.push(obj);\n\n\t\t\tuniqueSetId.push(val[uniqueId]);\n\t\t}\n\t}\n\n\tstore.objects.sort(function (a, b) {\n\t\tif (a.sortValue1 === b.sortValue1) {\n\t\t\treturn a.sortValue2 > b.sortValue2 ? 1 : -1;\n\t\t}\n\n\t\treturn a.sortValue1 > b.sortValue1 ? 1 : -1;\n\t});\n\n\t$('#' + settings.htmlDOMelementID).autocomplete({\n\t\tlookup: store.objects,\n\t\tonSelect: function (suggestion) {\n\t\t\tif (settings.onClick) {\n\t\t\t\tsettings.onClick(data.get(suggestion.index));\n\t\t\t}\n\t\t},\n\t\tformatResult: function (suggestion, currentValue) {\n\t\t\tif (settings.onFormat) {\n\t\t\t\treturn settings.onFormat(suggestion, currentValue);\n\t\t\t} else {\n\t\t\t\tvar str = '';\n\n\t\t\t\tstr += '<div class=\"autocomplete-icon backblue\"><i class=\"fa fa-dot-circle-o\" aria-hidden=\"true\"></i></div>';\n\t\t\t\tstr += '<div style=\"line-height: 32px;\">' + suggestion.value.replace(new RegExp(currentValue.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, \"\\\\$&\"), 'gi'), '<strong>' + currentValue + '</strong>') + '</div>';\n\t\t\t\treturn str;\n\t\t\t}\n\t\t},\n\t\torientation: settings.orientation,\n\t\tshowNoSuggestionNotice: settings.showNoSuggestion,\n\t\tnoSuggestionNotice: settings.titleNoSuggestion\n\t});\n}\n\n// -----------------------------------------------------------------------------\n\nexport function autostart(options) {\n\tvar noSuggestion = tools.getSelectionHTML('[data-search=\"noSuggestion\"]') || settings.titleNoSuggestion,\n\t\tpinColor = tools.getMetaContent('ddj:pinColor') || '',\n\t\tpinColorColumn = tools.getMetaContent('ddj:pinColorColumn') || '',\n\t\tpinIcon = tools.getMetaContent('ddj:pinIcon') || '',\n\t\tpinIconColumn = tools.getMetaContent('ddj:pinIconColumn') || '',\n\t\tpinIconPrefix = tools.getMetaContent('ddj:pinIconPrefix') || '',\n\t\tpinIconPrefixColumn = tools.getMetaContent('ddj:pinIconPrefixColumn') || '',\n\t\tsearchTitleColumn = tools.getMetaContent('ddj:searchTitleColumn') || '',\n\t\tsearchDescriptionColumn = tools.getMetaContent('ddj:searchDescriptionColumn') || '',\n\t\tuniqueId = data.getUniqueIdentifier();\n\n\tinit({\n\t\torientation: 'auto',\n\t\tshowNoSuggestion: true,\n\t\ttitleNoSuggestion: noSuggestion,\n\t\tonAdd: function (obj, value) {\n\t\t\tvar name = '',\n\t\t\t\tdescription = '',\n\t\t\t\tcolor = 'blue',\n\t\t\t\ticonPrefix = 'fa',\n\t\t\t\ticonFace = 'fa-dot-circle-o';\n\n\t\t\tif ((searchTitleColumn !== '') && value[searchTitleColumn]) {\n\t\t\t\tname = value[searchTitleColumn];\n\t\t\t}\n\t\t\tif ((searchDescriptionColumn !== '') && value[searchDescriptionColumn]) {\n\t\t\t\tdescription = value[searchDescriptionColumn];\n\t\t\t}\n\n\t\t\tif (pinColor !== '') {\n\t\t\t\tcolor = pinColor;\n\t\t\t}\n\t\t\tif ((pinColorColumn !== '') && value[pinColorColumn]) {\n\t\t\t\tcolor = value[pinColorColumn];\n\t\t\t}\n\n\t\t\tif (pinIcon !== '') {\n\t\t\t\ticonPrefix = pinIconPrefix;\n\t\t\t\ticonFace = pinIcon;\n\t\t\t}\n\t\t\tif ((pinIconColumn !== '') && value[pinIconColumn]) {\n\t\t\t\ticonPrefix = value[pinIconPrefixColumn];\n\t\t\t\ticonFace = value[pinIconColumn];\n\t\t\t}\n\n\t\t\tobj.sortValue1 = name;\n\t\t\tobj.sortValue2 = value[uniqueId];\n\t\t\tobj.data = value[uniqueId];\n\t\t\tobj.color = color;\n\t\t\tobj.value = name;\n\t\t\tobj.desc = description;\n\t\t\tobj.iconPrefix = iconPrefix;\n\t\t\tobj.iconFace = iconFace;\n\n\t\t\treturn true;\n\t\t},\n\t\tonFocus: function () {\n\t\t\twindow.scrollTo(0, 0);\n\t\t\tdocument.body.scrollTop = 0;\n\t\t\t$('#pageMap').animate({\n\t\t\t\tscrollTop: parseInt(0, 10)\n\t\t\t}, 500);\n\t\t},\n\t\tonFormat: function (suggestion, currentValue) {\n\t\t\tvar color = suggestion.color,\n\t\t\t\ticonPrefix = suggestion.iconPrefix,\n\t\t\t\ticonFace = suggestion.iconFace,\n\t\t\t\tstr = '';\n\n\t\t\tstr += '<div class=\"autocomplete-icon back' + color + '\"><i class=\"' + iconPrefix + ' ' + iconFace + '\" aria-hidden=\"true\"></i></div>';\n\t\t\tstr += '<div>' + suggestion.value.replace(new RegExp(currentValue.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, \"\\\\$&\"), 'gi'), '<strong>' + currentValue + '</strong>') + '</div>';\n\t\t\tstr += '<div class=\"' + color + '\">' + suggestion.desc + '</div>';\n\t\t\treturn str;\n\t\t},\n\t\tonClick: function (data) {\n\t\t\tif (options.onClick) {\n\t\t\t\tif (Array.isArray(data)) {\n\t\t\t\t\toptions.onClick(data[0][uniqueId]);\n\t\t\t\t} else {\n\t\t\t\t\toptions.onClick(data[uniqueId]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n}\n\n// -----------------------------------------------------------------------------\n","/*jslint browser: true*/\n/*global $,window*/\n\n// -----------------------------------------------------------------------------\n\nconst store = {\n}\n\nexport default store;\n\n// -----------------------------------------------------------------------------\n\nconst settings = {\n};\n\n// -----------------------------------------------------------------------------\n\nfunction updatePagesAndButtons() {\n\tvar tutorial = $('[data-tutorial=\"dialog\"]'),\n\t\tpageElement = $('[data-tutorial-currentpage]')[0],\n\t\tpage = parseInt(pageElement.textContent, 10),\n\t\tpages = tutorial.find('[data-tutorial=\"page\"]'),\n\t\tpositionTo = $(pages[page - 1]).data('position-to'),\n\t\tcontrolgroupLinks = tutorial.find('[data-role=\"controlgroup\"] a'),\n\t\tback = $(controlgroupLinks[0]);\n\n\tpages.css('display', 'none');\n\t$(pages[page - 1]).css('display', 'block');\n\n\ttutorial.popup('option', 'positionTo', positionTo || 'origin');\n\n\tif (page < 2) {\n\t\tback.removeClass('disabled').addClass('disabled');\n\t} else {\n\t\tback.removeClass('disabled');\n\t}\n}\n\n// -----------------------------------------------------------------------------\n\nexport function init() {\n\tif (!document.querySelector('[data-tutorial=\"dialog\"]')) {\n\t\treturn;\n\t}\n\n\tvar tutorial = $('[data-tutorial=\"dialog\"]');\n\tvar pages = tutorial.find('[data-tutorial=\"page\"]');\n\n\ttutorial.append(\n\t\t'<div data-tutorial=\"footer\">' +\n\t\t\t'<div>' +\n\t\t\t\t'Seite <span data-tutorial-currentpage>1</span> von ' + pages.length +\n\t\t\t'</div>' +\n\t\t\t'<div data-role=\"controlgroup\" data-type=\"horizontal\">' +\n\t\t\t\t'<a href=\"#\" class=\"ui-btn ui-corner-all ui-btn-a\" onclick=\"ddj.tutorial.onBack()\"><i class=\"fa fa-chevron-left\" aria-hidden=\"true\"></i></a>' +\n\t\t\t\t'<a href=\"#\" class=\"ui-btn ui-corner-all ui-btn-a\" onclick=\"ddj.tutorial.onNext()\"><i class=\"fa fa-chevron-right\" aria-hidden=\"true\"></i></a>' +\n\t\t\t'</div>' +\n\t\t'</div>'\n\t);\n\n\tvar controlgroups = tutorial.find('[data-role=\"controlgroup\"]');\n\tcontrolgroups.controlgroup({direction: \"horizontal\"});\n\n\t$('[data-tutorial=\"dialog\"]').popup({\n\t\tafterclose: function() {\n\t\t\tgotoFirstPage();\n\t\t}\n\t});\n\n\tgotoFirstPage();\n}\n\n// -----------------------------------------------------------------------------\n\nexport function update() {\n}\n\n// -----------------------------------------------------------------------------\n\nexport function gotoFirstPage() {\n\tvar pageElement = $('[data-tutorial-currentpage]')[0];\n\n\tpageElement.textContent = 1;\n\n\tupdatePagesAndButtons();\n}\n\n// -----------------------------------------------------------------------------\n\nexport function onBack() {\n\tvar pageElement = $('[data-tutorial-currentpage]')[0],\n\t\tpage = parseInt(pageElement.textContent, 10);\n\n\tif (page > 1) {\n\t\tpageElement.textContent = page - 1;\n\t}\n\n\tupdatePagesAndButtons();\n}\n\n// -----------------------------------------------------------------------------\n\nexport function onNext() {\n\tvar pageElement = $('[data-tutorial-currentpage]')[0],\n\t\tpages = $('[data-tutorial=\"dialog\"]').find('[data-tutorial=\"page\"]'),\n\t\tpage = parseInt(pageElement.textContent, 10);\n\n\tif (page < pages.length) {\n\t\tpageElement.textContent = page + 1;\n\n\t\tupdatePagesAndButtons();\n\t} else {\n\t\t$('[data-tutorial=\"dialog\"]').popup('close');\n\t}\n}\n\n// -----------------------------------------------------------------------------\n\nexport function autostart() {\n\tinit();\n\n\twindow.setTimeout(function() {\n\t\tif (document.querySelector('[data-tutorial=\"dialog\"]')) {\n\t\t\t$('[data-tutorial=\"dialog\"]').popup('open');\n\t\t}\n\t}, 0);\n}\n\n// -----------------------------------------------------------------------------\n","/*jslint browser: true*/\n/*global L,window,XMLHttpRequest,history*/\n\n// -----------------------------------------------------------------------------\n\nimport * as data from './ddj.data';\nimport * as map from './ddj.map';\nimport * as mapcontrols from './ddj.mapcontrols';\nimport * as marker from './ddj.marker';\nimport * as quickinfo from './ddj.quickinfo';\nimport * as search from './ddj.search';\nimport * as tools from './ddj.tools';\nimport * as tutorial from './ddj.tutorial';\n\n// -----------------------------------------------------------------------------\n\nconst store = {\n\tselectedItem: null,\n\tonDoneCallback: null,\n\teventPageShowWasSet: false,\n}\n\nexport default store;\n\n// -----------------------------------------------------------------------------\n\nfunction getJSON(uri, successCallback) {\n\tvar promiseObject = {\n\t\tonDone: null,\n\t\tonFail: null,\n\t\tonAlways: null,\n\n\t\tdone: function(callback) {\n\t\t\tthis.onDone = callback;\n\t\t\treturn this;\n\t\t},\n\t\tfail: function(callback) {\n\t\t\tthis.onFail = callback;\n\t\t\treturn this;\n\t\t},\n\t\talways: function(callback) {\n\t\t\tthis.onAlways = callback;\n\t\t\treturn this;\n\t\t},\n\t};\n\n\tvar request = new XMLHttpRequest();\n\trequest.open('GET', uri, true);\n\n\trequest.onreadystatechange = function() {\n\t\tif (this.readyState === 4) {\n\t\t\tif (this.status >= 200 && this.status < 400) {\n\t\t\t\tvar jsonData = JSON.parse(this.responseText);\n\t\t\t\tif (successCallback) {\n\t\t\t\t\tsuccessCallback(jsonData);\n\t\t\t\t}\n\t\t\t\tif (promiseObject.onDone) {\n\t\t\t\t\tpromiseObject.onDone(jsonData);\n\t\t\t\t}\n\t\t\t\tif (promiseObject.onAlways) {\n\t\t\t\t\tpromiseObject.onAlways();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (promiseObject.onFail) {\n\t\t\t\t\tpromiseObject.onFail(/*jqxhr*/null, /*textStatus*/'', /*error*/null);\n\t\t\t\t}\n\t\t\t\tif (promiseObject.onAlways) {\n\t\t\t\t\tpromiseObject.onAlways();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\trequest.send();\n\trequest = null;\n\n\treturn promiseObject;\n}\n\n// -----------------------------------------------------------------------------\n\nfunction getWFS(uri, successCallback) {\n\tvar promiseObject = {\n\t\tonDone: null,\n\t\tonFail: null,\n\t\tonAlways: null,\n\n\t\tdone: function(callback) {\n\t\t\tthis.onDone = callback;\n\t\t\treturn this;\n\t\t},\n\t\tfail: function(callback) {\n\t\t\tthis.onFail = callback;\n\t\t\treturn this;\n\t\t},\n\t\talways: function(callback) {\n\t\t\tthis.onAlways = callback;\n\t\t\treturn this;\n\t\t},\n\t};\n\n\tvar boundaries = new L.WFS({\n\t\turl: uri,\n\t\ttypeNS: 'topp',\n\t\ttypeName: 'fis:s_schulen',\n\t\tcrs: L.CRS.EPSG4326,\n\t\tstyle: {\n\t\t\tcolor: 'blue',\n\t\t\tweight: 2\n\t\t}\n\t}).addTo(map.get())\n\t.on('load', function () {\n\t\tmap.get().fitBounds(boundaries);\n\t})\n\t.on('error', function () {\n\t});\n\n\treturn promiseObject;\n}\n\n// -----------------------------------------------------------------------------\n\nfunction cleanURI() {\n\tif (window.location.hash) {\n\t\thistory.replaceState(null, null, ' ');\n\t}\n}\n\n// -----------------------------------------------------------------------------\n\nfunction updateMapSelectItem(selectedItem) {\n\tstore.selectedItem = selectedItem;\n\n\tquickinfo.show(store.selectedItem);\n}\n\n// -----------------------------------------------------------------------------\n\nfunction selectSuggestion(selection) {\n\tvar key, val, items = data.get(), uniqueId = data.getUniqueIdentifier();\n\n\tfor (key = 0; key < items.length; ++key) {\n\t\tval = items[key];\n\n\t\tif (val && (val[uniqueId] === selection)) {\n\t\t\tif (val.lat && val.lng) {\n\t\t\t\tmap.get().panTo(new L.LatLng(val.lat, val.lng));\n\t\t\t}\n\t\t\tupdateMapSelectItem(tools.getAllObjects(val));\n\n\t\t\treturn;\n\t\t}\n\t}\n}\n\n// -----------------------------------------------------------------------------\n\nfunction onPageShow() {\n\tvar dataUris = tools.getMetaContentArray('ddj:data'),\n\t\tdataIgnoreSecondLines = tools.getMetaContentArray('ddj:dataIgnoreSecondLine'),\n\t\tdataIgnoreLastLines = tools.getMetaContentArray('ddj:dataIgnoreLastLine'),\n\t\tdataNoCaches = tools.getMetaContentArray('ddj:dataNoCache'),\n\t\tdataUniqueIdentifier = tools.getMetaContent('ddj:dataUniqueIdentifier') || '',\n\t\tdataWFSs = tools.getMetaContentArray('ddj:wfs');\n\n\tfunction onDone() {\n\t\tquickinfo.autostart();\n\n\t\tmarker.autostart({\n\t\t\tonClick: function (latlng, item) {\n\t\t\t\tupdateMapSelectItem(tools.getAllObjects(item));\n\t\t\t},\n\t\t});\n\n\t\tsearch.autostart({\n\t\t\tonClick: function (item) {\n\t\t\t\tselectSuggestion(item);\n\t\t\t},\n\t\t});\n\n\t\ttools.showSelection('.visibleWithoutData', false);\n\t\ttools.showSelection('.visibleWithData', true);\n\t}\n\n\tfunction onFail() {\n\t\ttools.showSelection('.visibleWithoutErrors', false);\n\t\ttools.showSelection('.visibleWithErrors', true);\n\t}\n\n\tfunction onAlways() {\n\t\tif (store.onDoneCallback) {\n\t\t\tstore.onDoneCallback();\n\t\t}\n\t}\n\n\tfunction loadData(index) {\n\t\tif (index < dataUris.length) {\n\t\t\tvar dataUri = dataUris[index],\n\t\t\t\tdataIgnoreSecondLine = (index < dataIgnoreSecondLines.length ? dataIgnoreSecondLines[index] : '') === 'true',\n\t\t\t\tdataIgnoreLastLine = (index < dataIgnoreLastLines.length ? dataIgnoreLastLines[index] : '') === 'true',\n\t\t\t\tdataNoCache = (index < dataNoCaches.length ? dataNoCaches[index] : '') === 'true',\n\t\t\t\tdataWFS = (index < dataWFSs.length ? dataWFSs[index] : '') === 'true';\n\n\t\t\tif (dataNoCache) {\n\t\t\t\tdataUri += '?nocache=' + (new Date().getTime());\n\t\t\t}\n\n\t\t\tif (dataWFS) {\n\t\t\t\tgetWFS(dataUri, function() {\n\t\t\t\t\t\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tgetJSON(dataUri, function (jsonObject) {\n\t\t\t\t\tvar jsonData = jsonObject;\n\n\t\t\t\t\tif (dataIgnoreSecondLine) {\n\t\t\t\t\t\tjsonData.shift();\n\t\t\t\t\t}\n\t\t\t\t\tif (dataIgnoreLastLine) {\n\t\t\t\t\t\tjsonData.pop();\n\t\t\t\t\t}\n\n\t\t\t\t\tdata.init(jsonData);\n\n\t\t\t\t\tif (dataUniqueIdentifier !== '') {\n\t\t\t\t\t\tdata.setUniqueIdentifier(dataUniqueIdentifier);\n\t\t\t\t\t}\n\t\t\t\t}).done(function() {\n\t\t\t\t\tloadData(index + 1);\n\t\t\t\t}).fail(function() {\n\t\t\t\t\tonFail();\n\t\t\t\t\tonAlways();\n\t\t\t\t});\n\t\t\t}\n\t\t} else {\n\t\t\tif (index > 0) {\n\t\t\t\tonDone();\n\t\t\t}\n\t\t\tonAlways();\n\t\t}\t\t\t\t\t\t\n\t}\n\n\tcleanURI();\n\n\tstore.selectedItem = null;\n\ttools.setSelectionValue('[data-search=\"textinput\"]', '');\n\tmap.autostart();\n\tmapcontrols.autostart();\n\ttutorial.autostart();\n\n\tloadData(0);\n}\n\n// -----------------------------------------------------------------------------\n// https://github.com/Rob--W/cors-anywhere/#documentation\n\n(function() {\n\tvar cors_api_host = 'cors-anywhere.herokuapp.com';\n\tvar cors_api_url = 'https://' + cors_api_host + '/';\n\tvar slice = [].slice;\n\tvar origin = window.location.protocol + '//' + window.location.host;\n\tvar open = XMLHttpRequest.prototype.open;\n\tXMLHttpRequest.prototype.open = function() {\n\t\tvar args = slice.call(arguments);\n\t\tvar targetOrigin = /^https?:\\/\\/([^\\/]+)/i.exec(args[1]);\n\t\tif (targetOrigin && targetOrigin[0].toLowerCase() !== origin &&\n\t\t\ttargetOrigin[1] !== cors_api_host) {\n\t\t\targs[1] = cors_api_url + args[1];\n\t\t}\n\t\treturn open.apply(this, args);\n\t};\n})();\n\n// -----------------------------------------------------------------------------\n\nif (!store.eventPageShowWasSet) {\n\tstore.eventPageShowWasSet = true;\n\n\twindow.addEventListener('pageshow', onPageShow);\n}\n\n// -----------------------------------------------------------------------------\n\nexport function onDone(callback) {\n\tstore.onDoneCallback = callback;\n}\n\n// -----------------------------------------------------------------------------\n"],"sourceRoot":""}